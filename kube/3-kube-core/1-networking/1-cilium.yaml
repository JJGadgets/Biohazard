apiVersion: v1
kind: ConfigMap
metadata:
    name: bgp-config
    namespace: kube-system
data:
    config.yaml: ENC[AES256_GCM,data:EUahnRTYyRLzQ3WVp+yo5ojvtQI0Om4htEnOOJ6zVvU/5QdBBQ8eu/7+z0RkGbw8+4v4WyGfjfpSebObJZiXtQaakTwTu6fuF2qECyLDOw3d/ETzUPoEBcbRZxQ4DQLJtZEXYjmKMf3+Ky8ebtDcE/PSyEIATUYi9mSkt1zis4u2JU8j7+STDpSi4cneoCz6j07N8et4uEON31jU4FXK3P8C8RW4uCmWIJHKbJ83DwCPd1xO1VEJ2m0VjI8WfdROfhTFMpJ1csXNc59kytVa9s/nMirguoXe1ODfFhsEu8G4v8uVPKPRf5JEJMw2oVDR37qUZQaDSmsTUFX0EubGRZMr3updjqmTl81MF4fiHDV3Sw==,iv:i6suLWWbk2lK8bHzvGTV/PAOExGBSRGwt2JxZ2mJoPs=,tag:lY8oINK+7dqV8JxDauPYMQ==,type:str]
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1xl3fcwdw56k73lraxsjhde4ygwn7jw0js5l5qw7vsp54vc5czuwstcejxu
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBIODMzMzBtOG05MUdjWlBL
            OE5jQ0Y2QVhGT2pGVytQYWszeS9mS2VLZ3hrClkrMmpINy9oRm0rSU5CbWVlVkpV
            VzVIV1RYdkxSMFJxVkRLNVhIR016elUKLS0tIFM5Q2ZDTm1JaFErcjlpWVhaaEZo
            MFJGWXh1UXU3REpNNGt4aExiMEQ4SmcKl2YxWWp9ABxTnLDDstwFaj9pDTZQJzDY
            kj16Q+smYAmO20yKRHLQvseqSXOV7RO2AB86Pef2vYW2r04txS2/uw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2023-02-18T22:46:40Z"
    mac: ENC[AES256_GCM,data:eWVSKlLT64fwbNEWsD6p/l5f+foQFK8Cm7QiufF8QC7CYRltTsj0EQJoLclvauew6h4zrIqAFqDl7WdSQQB7F3ZdH9Dri5MvfACeBcAiVjRTYUt8trCCFBNH8uqva7xsH7qKWvvJ2Bnsj89yAk8DJLQpUP4ZvQOH+3fih7+xMDM=,iv:KdTxS1WZXtFeMJDbmhrLWVZQAkS/J1cLZTPMsnnxE+U=,tag:/vJuFoHEWlxAiZIKuyDbPQ==,type:str]
    pgp:
        - created_at: "2023-02-03T05:00:34Z"
          enc: |
            -----BEGIN PGP MESSAGE-----

            hF4DAAAAAAAAAAASAQdAibIpgsTH9MMDrZETVo3PRPyH6YHC+A+Pdth1GFTnSAMw
            VqPbDlwljLzPfhfyn7AslZbURvSeJPjXQK2VoYI30k1wT/2e+Nc6NcdGBr7PAJ1d
            0l4BS6MPHgzX2i/gBr6/ZPNLaQ1Y+JGAtihxGINpX69ZZViFjxYRqKv2GXfN06V8
            DNpwnpTwfUO9uWsGqDJTV7kqujBaGf2IgOC+e4SFawndv7Xw8/mYV2LP18SgtcUE
            =4ZsZ
            -----END PGP MESSAGE-----
          fp: 31E70E5BC80C58AFF5DD649921AC5A1AC6E5B7F2
    encrypted_regex: ^(peer-address|peer-asn|my-asn|addresses|config.yaml|ipv4NativeRoutingCIDR|k8sServiceHost|clusterDomain)$
    version: 3.7.3
---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
    name: cilium
    namespace: kube-system
    annotations:
        meta.helm.sh/release-name: cilium
        meta.helm.sh/release-namespace: kube-system
    labels:
        app.kubernetes.io/managed-by: Helm
spec:
    interval: 5m
    chart:
        spec:
            chart: cilium
            version: 1.13.0
            sourceRef:
                kind: HelmRepository
                name: cilium-charts
                namespace: flux-system
            interval: 5m
    install:
        # perform remediation when helm install fails
        remediation:
            retries: 100
    upgrade:
        # perform remediation when helm upgrade fails
        remediation:
            retries: 100
            # remediate the last failure, when no retries remain
            remediateLastFailure: true
        cleanupOnFail: true
    values:
        securityContext:
            privileged: true
        cluster:
            name: Biohazaard
            id: "1"
        tunnel: disabled
        ipam:
            mode: kubernetes
        eni:
            enabled: true
        bgp:
            enabled: true
            announce:
                loadbalancerIP: true
                podCIDR: true
        loadBalancer:
            algorithm: maglev
            mode: dsr
        nodePort:
            enabled: true
            range: 80,32767
        ipv4NativeRoutingCIDR: ENC[AES256_GCM,data:QSZ7owor1GF/kkbHnA==,iv:5KseRVtTLNzg1IuaobDTHEVi50b/R8JSC8wDvSrXke4=,tag:5NUNdALTyzF7PH98bP1Fqw==,type:str]
        kubeProxyReplacement: strict
        k8sServiceHost: ENC[AES256_GCM,data:Pg5VZd2nk66M,iv:JgJjaStsiBTitBTBnaEZxYUoVVmagiB9EViloT9dguw=,tag:gaNqRAwwwb9QG2w89Phb+w==,type:str]
        k8sServicePort: 6443
        kubeProxyReplacementHealthzBindAddr: 0.0.0.0:10256
        install-no-conntrack-iptables-rules: "false"
        operator:
            rollOutPods: true
        autoDirectNodeRoutes: false
        rollOutCiliumPods: true
        localRedirectPolicy: true
        containerRuntime:
            integration: containerd
        hubble:
            peerService:
                clusterDomain: ENC[AES256_GCM,data:gkXwEcVY7o0=,iv:+nzoVFBBezJb4WS0H5CYMMhd6fMfHCIkIR5DdvSxFqc=,tag:OxKEJNtwBeGAw9CrPHFD5Q==,type:str]
            enabled: true
            tls:
                enabled: false
            relay:
                enabled: true
                tls:
                    server:
                        enabled: false
            ui:
                enabled: true
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1xl3fcwdw56k73lraxsjhde4ygwn7jw0js5l5qw7vsp54vc5czuwstcejxu
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBIODMzMzBtOG05MUdjWlBL
            OE5jQ0Y2QVhGT2pGVytQYWszeS9mS2VLZ3hrClkrMmpINy9oRm0rSU5CbWVlVkpV
            VzVIV1RYdkxSMFJxVkRLNVhIR016elUKLS0tIFM5Q2ZDTm1JaFErcjlpWVhaaEZo
            MFJGWXh1UXU3REpNNGt4aExiMEQ4SmcKl2YxWWp9ABxTnLDDstwFaj9pDTZQJzDY
            kj16Q+smYAmO20yKRHLQvseqSXOV7RO2AB86Pef2vYW2r04txS2/uw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2023-02-18T22:46:40Z"
    mac: ENC[AES256_GCM,data:eWVSKlLT64fwbNEWsD6p/l5f+foQFK8Cm7QiufF8QC7CYRltTsj0EQJoLclvauew6h4zrIqAFqDl7WdSQQB7F3ZdH9Dri5MvfACeBcAiVjRTYUt8trCCFBNH8uqva7xsH7qKWvvJ2Bnsj89yAk8DJLQpUP4ZvQOH+3fih7+xMDM=,iv:KdTxS1WZXtFeMJDbmhrLWVZQAkS/J1cLZTPMsnnxE+U=,tag:/vJuFoHEWlxAiZIKuyDbPQ==,type:str]
    pgp:
        - created_at: "2023-02-03T05:00:34Z"
          enc: |
            -----BEGIN PGP MESSAGE-----

            hF4DAAAAAAAAAAASAQdAibIpgsTH9MMDrZETVo3PRPyH6YHC+A+Pdth1GFTnSAMw
            VqPbDlwljLzPfhfyn7AslZbURvSeJPjXQK2VoYI30k1wT/2e+Nc6NcdGBr7PAJ1d
            0l4BS6MPHgzX2i/gBr6/ZPNLaQ1Y+JGAtihxGINpX69ZZViFjxYRqKv2GXfN06V8
            DNpwnpTwfUO9uWsGqDJTV7kqujBaGf2IgOC+e4SFawndv7Xw8/mYV2LP18SgtcUE
            =4ZsZ
            -----END PGP MESSAGE-----
          fp: 31E70E5BC80C58AFF5DD649921AC5A1AC6E5B7F2
    encrypted_regex: ^(peer-address|peer-asn|my-asn|addresses|config.yaml|ipv4NativeRoutingCIDR|k8sServiceHost|clusterDomain)$
    version: 3.7.3
