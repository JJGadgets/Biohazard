apiVersion: v1
kind: ConfigMap
metadata:
    name: bgp-config
    namespace: kube-system
data:
    config.yaml: ENC[AES256_GCM,data:EUxBzGoKjMZfE61zCTPJtXMKArQCm0U/Er5x+1VEbUbKDB2GqtBqAtplKDiUSDiSGGKMFg5jrCZk2YvrggOZ//n3d9mua37SrVcLlhK2RJox5QpEoyvPDQJZmvff9omYuNtGarnuLQiiIFPhI/BdE7PKwvFWd2r+6XAS6o1dtqiOpikwTaQb0cjS642eaVuV0g52jkWOBnmuG9arbSmAEKktCb/ObghznPl5wq6E/BT+Z7G/1M7HYPMJeKwbKR9KQgWGuNwShP76gTnRIpw=,iv:3OEmjSE/XiDxmzb6BI2FlIhWSw7JjH5pMHQ6kt47Uck=,tag:SACnhC2rSfFu4VofJCd7Gg==,type:str]
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1xl3fcwdw56k73lraxsjhde4ygwn7jw0js5l5qw7vsp54vc5czuwstcejxu
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSB6YVZWdUtFekJScFJLb0lu
            UnMyMlZtTzVoKzFaOEx3ekg1TlNVRWhlUUhFCjFZL2ZiWkJnalZtZ1orVXFqV3U5
            eXk2cTJPMlRmSDI1NWQxSmZOTVhUM2sKLS0tIENRZjkrUWVSbWxhWm5SR1dxYUxV
            ZDF5aFJBREplN28wQUtrYWJWVk1nSXcK7rHfu4MX3ZlOuMvgu543+HCWD7JqMkr+
            IIiK/sOBHxZVSGr0oOOLMaKYl7JYYXBppRVPICGbwPHDwjW9ml5H4w==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2023-02-02T15:53:37Z"
    mac: ENC[AES256_GCM,data:DkWmJCkFWY2mM3G5aEqOeuXk/sD/7DokgvQf149D+jEq7VH6glJ8TQfsHRAaSHcCEk8Gi/6HhWgAWDOG8elyLxuqnvgk/eeijx3oYpLZL0xNMyfDlXjbW6rfZYbzcCFuP4WltoR2FsHwjrAseLriQaTbfnpA0FwiebcebD9usDQ=,iv:C9+0pjQHqFwQTBAcMEG7GGd0ChPqRyYdpRxwCA/NcBc=,tag:23x/f5OGPqNcP4IMfjC13A==,type:str]
    pgp:
        - created_at: "2023-01-29T19:20:40Z"
          enc: |
            -----BEGIN PGP MESSAGE-----

            hF4DAAAAAAAAAAASAQdAhlZ3dQUsA4jV9FfkTCFga4hwAnzu/IPz0Rno0TB0ejow
            Hl52IhaOYOy3kK9BRSzcsBaPp+QpJgztFLb2210Bwmgphtpzr6qS45vm4sLzH0iL
            0lwBVsqTIC3tKVcFDDo9jyXG43J0FdHEg+c9DOUiidLX99isNMpotTctCxo5nAPL
            jHb7CEOt/E4YdVrz6ifSYYwRANbyHlhkGlw8Eu4qQrKjC7j3xnHzo6w5/IIeug==
            =HdhJ
            -----END PGP MESSAGE-----
          fp: 31E70E5BC80C58AFF5DD649921AC5A1AC6E5B7F2
    encrypted_regex: ^(peer-address|peer-asn|my-asn|addresses|config.yaml|ipv4NativeRoutingCIDR|k8sServiceHost|)$
    version: 3.7.3
---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
    name: cilium
    namespace: kube-system
    annotations:
        meta.helm.sh/release-name: cilium
        meta.helm.sh/release-namespace: kube-system
    labels:
        app.kubernetes.io/managed-by: Helm
spec:
    interval: 5m
    chart:
        spec:
            chart: cilium
            version: 1.12.5
            sourceRef:
                kind: HelmRepository
                name: cilium-charts
                namespace: flux-system
            interval: 5m
    install:
        # perform remediation when helm install fails
        remediation:
            retries: 100
    upgrade:
        # perform remediation when helm upgrade fails
        remediation:
            retries: 100
            # remediate the last failure, when no retries remain
            remediateLastFailure: true
        cleanupOnFail: true
    values:
        securityContext:
            privileged: true
        cluster:
            name: Biohazaard
            id: "1"
        tunnel: disabled
        ipam:
            mode: kubernetes
        bgp:
            enabled: true
            announce:
                loadbalancerIP: true
        loadBalancer:
            algorithm: maglev
            mode: dsr
        ipv4NativeRoutingCIDR: ENC[AES256_GCM,data:qpfe8rg4PR+oAMB5gQ==,iv:rXQMTV4R9+EBTiTfzdEGzbEbYcpEPQwyfp6QKyNP524=,tag:1N8429AMaOsWmDwvu9FIdQ==,type:str]
        kubeProxyReplacement: strict
        k8sServiceHost: ENC[AES256_GCM,data:u2mry59EfR7a,iv:IkE4URwvtPTdAG1PwxfLZrxhHfkltzcX46ID7WVsPRM=,tag:nJD5YbaJwce24WuzY8HipA==,type:str]
        k8sServicePort: 6443
        kubeProxyReplacementHealthzBindAddr: 0.0.0.0:10256
        install-no-conntrack-iptables-rules: "false"
        operator:
            rollOutPods: true
        autoDirectNodeRoutes: true
        rollOutCiliumPods: true
        localRedirectPolicy: true
        containerRuntime:
            integration: containerd
        hubble:
            enabled: true
            tls:
                enabled: false
            relay:
                enabled: true
                tls:
                    server:
                        enabled: false
            ui:
                enabled: true
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1xl3fcwdw56k73lraxsjhde4ygwn7jw0js5l5qw7vsp54vc5czuwstcejxu
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSB6YVZWdUtFekJScFJLb0lu
            UnMyMlZtTzVoKzFaOEx3ekg1TlNVRWhlUUhFCjFZL2ZiWkJnalZtZ1orVXFqV3U5
            eXk2cTJPMlRmSDI1NWQxSmZOTVhUM2sKLS0tIENRZjkrUWVSbWxhWm5SR1dxYUxV
            ZDF5aFJBREplN28wQUtrYWJWVk1nSXcK7rHfu4MX3ZlOuMvgu543+HCWD7JqMkr+
            IIiK/sOBHxZVSGr0oOOLMaKYl7JYYXBppRVPICGbwPHDwjW9ml5H4w==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2023-02-02T15:53:37Z"
    mac: ENC[AES256_GCM,data:DkWmJCkFWY2mM3G5aEqOeuXk/sD/7DokgvQf149D+jEq7VH6glJ8TQfsHRAaSHcCEk8Gi/6HhWgAWDOG8elyLxuqnvgk/eeijx3oYpLZL0xNMyfDlXjbW6rfZYbzcCFuP4WltoR2FsHwjrAseLriQaTbfnpA0FwiebcebD9usDQ=,iv:C9+0pjQHqFwQTBAcMEG7GGd0ChPqRyYdpRxwCA/NcBc=,tag:23x/f5OGPqNcP4IMfjC13A==,type:str]
    pgp:
        - created_at: "2023-01-29T19:20:40Z"
          enc: |
            -----BEGIN PGP MESSAGE-----

            hF4DAAAAAAAAAAASAQdAhlZ3dQUsA4jV9FfkTCFga4hwAnzu/IPz0Rno0TB0ejow
            Hl52IhaOYOy3kK9BRSzcsBaPp+QpJgztFLb2210Bwmgphtpzr6qS45vm4sLzH0iL
            0lwBVsqTIC3tKVcFDDo9jyXG43J0FdHEg+c9DOUiidLX99isNMpotTctCxo5nAPL
            jHb7CEOt/E4YdVrz6ifSYYwRANbyHlhkGlw8Eu4qQrKjC7j3xnHzo6w5/IIeug==
            =HdhJ
            -----END PGP MESSAGE-----
          fp: 31E70E5BC80C58AFF5DD649921AC5A1AC6E5B7F2
    encrypted_regex: ^(peer-address|peer-asn|my-asn|addresses|config.yaml|ipv4NativeRoutingCIDR|k8sServiceHost|)$
    version: 3.7.3
