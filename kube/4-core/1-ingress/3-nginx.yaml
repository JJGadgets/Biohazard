# yaml-language-server: $schema=https://kubernetes-schemas.devbu.io/helmrelease_v2beta1.json
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
    name: ingress-nginx
    namespace: ingress
spec:
    interval: 15m
    chart:
        spec:
            chart: ingress-nginx
            version: 4.4.2
            sourceRef:
                kind: HelmRepository
                name: ingress-nginx
                namespace: flux-system
    maxHistory: 3
    install:
        createNamespace: true
        remediation:
            retries: 3
    upgrade:
        cleanupOnFail: true
        remediation:
            retries: 3
    uninstall:
        keepHistory: false
    values:
        controller:
            replicaCount: 3
            extraEnvs:
                - name: TZ
                  value: Asia/Singapore
            service:
                externalIPs:
                    - ENC[AES256_GCM,data:+m0lvqJhFIRNWek=,iv:4KiVoYXjQEWPC+QFtAJjgduAnFi40wgcHaNiUlo6jp8=,tag:9SEwybjGoumVob73IKZdUg==,type:str]
                externalTrafficPolicy: Local
            publishService:
                enabled: true
            ingressClassResource:
                default: true
            config:
                client-body-timeout: 10
                client-header-timeout: 10
                enable-brotli: "true"
                enable-real-ip: "true"
                disable-access-log: "true"
                use-forwarded-headers: "true"
                hsts-max-age: "31449600"
                hsts-preload: "true"
                keep-alive: 10
                log-format-escape-json: "true"
                proxy-body-size: 100K
                ssl-protocols: TLSv1.3 TLSv1.2
                ssl-ciphers: ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305
                hide-headers: Server,X-Powered-By
                enable-ocsp: "true"
                large-client-header-buffers: 2 1k
            # metrics:
            #   enabled: true
            #   serviceMonitor:
            #     enabled: true
            #     namespace: networking
            #     namespaceSelector:
            #       any: true
            extraArgs:
                default-ssl-certificate: ingress/short-domain-tls
            resources:
                requests:
                    cpu: 10m
                    memory: 250Mi
                limits:
                    memory: 500Mi
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1xl3fcwdw56k73lraxsjhde4ygwn7jw0js5l5qw7vsp54vc5czuwstcejxu
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBTQnhid1E1M0lCZkVvSTlE
            RnVSZE5UZjFEQnFXb25xckptSU1lK2JRWm1jClZBOXVmZk8rOERUa2JuNGNMSGVm
            aXhBSnpNRjMrL2tlZVNnZDdKT3ZWc2sKLS0tIDIvWTlTN2lCcCtxaDFtR2dzK2RX
            aWxFR1pEdklwUTdJY1hmTGJmd2paMGsKjEMN6QYNQK3PoMF6VrlvYgtgDEv+63yy
            bpaEiToGg3HTX6KV8UCxwl07QGzs2XgIKoilgmisL61hkVuVO+BFSA==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2023-02-01T02:49:10Z"
    mac: ENC[AES256_GCM,data:CBxgH9TewAQfGMvBBdL4qG4d9haOA+00UXD5Odax2ksv4ioFQE8S2yuT7BH9JiMMhSR97nUthV/yT/yqyoMpAZATZe5VLVjLjV50zxdMNZWy/tEDEc7lVz3l/Z0BOgj2vGx4s7w5cYr198N5y0B8GjR8kjbsTWLVA1pJiay9it8=,iv:XnAw0Gyy3gGrWb/qRfA1nrJnSK/JaamDVXiybvJ5RZY=,tag:luaYvq2rWEor/pP9gCiaAw==,type:str]
    pgp:
        - created_at: "2023-01-29T08:04:23Z"
          enc: |
            -----BEGIN PGP MESSAGE-----

            hF4DAAAAAAAAAAASAQdA7bzu+R0a8NlB469skw/+MaERvUmNqZnpDF0DAanuREQw
            R+AjPtCDl83i58F8XX+IHNtd0dDnMtUBd66eZ/GWM9NReWuaKD66trhQh8lwxJM2
            0l4BfKmF7Umg0USdQ3ZFG3u3oprzkuBCMhf6H6EUdPTnoRkGcveABFTkHU/gXwsH
            eWajUqUwMNhFSFMg0eXS6YoEnV6AKh5kVLhmueMcaA7Nbyjejqs2XMm1bIhndOp9
            =kigG
            -----END PGP MESSAGE-----
          fp: 31E70E5BC80C58AFF5DD649921AC5A1AC6E5B7F2
    encrypted_regex: ^(data|stringData|commonName|dnsNames|externalIPs)$
    version: 3.7.3
