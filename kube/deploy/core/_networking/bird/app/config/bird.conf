router id ${IP_CLUSTER_VIP};
define ASN = ${ASN_CLUSTER_NODES};
define CiliumLBIPs = [
  ${IP_LB_CIDR}
];
define NodeIPs = [
  ${IP_ROUTER_VLAN_K8S_CIDR}
];
filter cilium {
  if (net ~ CiliumLBIPs) then accept;
  else reject;
}
filter nodes {
  if (net ~ NodeIPs) then accept;
  else reject;
}
protocol device {
  ipv4 {
    import filter nodes
  };
}
protocol direct {
  disabled;
}
protocol kernel {
  ipv4 {
    import all;
    export filter cilium;
  };
}
protocol static {
  disabled;
  ipv4;
}
protocol bgp CiliumBGP {
  ipv4 {
    import filter cilium;
  };
  multihop;
  local port 61790 as ASN;
  neighbor range ${IP_ROUTER_VLAN_K8S_CIDR} as ASN internal;
}

